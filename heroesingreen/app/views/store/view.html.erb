<style = text/css>
	.halfWidth {
		float:left;
		width:50%;
	}
	.halfWidth.left > * { margin-right: 10px; }
	.halfWidth.right > * { margin-left: 10px; }


	.submenu {
		background-color: #749355;
		min-height: 30px;
		line-height: 30px;
		width: 355px;
		margin: -5px 10px 5px 0;
		float: right;
	}

	#gardenView > * {
		text-align: center;
		margin-left: auto;
		margin-right: auto;
	}

	#garden-viewport {
		max-width: 100%;
		overflow: auto;
	}
	.garden {
		background:url('../images/Backgrounds/GardenBackgroundSmall.jpg') no-repeat;
		width: 718px; 
		height: 544px;
		clear: both;
		margin-left: auto;
		margin-right: auto;
	}
	#myGarden {
		background-color: #AA9355;
	}
	#myGarden a {
		color: #FFF;
	}
	.submenu_item {
		min-width: 75px;
		color: #000;
		float: left;
		text-align: center;
	}
	.submenu_item a {
		text-decoration: none;
		color: #000;
	}
	.submenu_item a:hover {
		color: #FFF;
	}
	#submenu_garden {
		color: #FFF;
	}
	.ground {
		width: 77px;
		height: 75px;
		border: 1px black hidden; 
		float: left;
		position: relative;
	}
	.highlighted {
		border-style: dotted !important;
		opacity: 0.5;
		background: #CEF;
	}
	.highlighted:hover {
		background: #CFE;
		cursor: hand; 
		cursor: pointer;
	}
	.plant_in_garden {
		position: absolute;
		bottom: 0;
	}
	.plant_in_garden img {
		opacity: 0.9;
	}
	.plant_in_garden img:hover {
		opacity:1;
	}
	.clear {clear:both;}

	#plant_store > ol {
		overflow-y: auto;
		height: 595px;
		padding: 0;
		list-style: none;
	}

	#plant_store > ol > li {
		clear:both;
		border-top: 2px solid #AF7;
	}
	#plant_store > ol > li:first-child { border-top: 0; }
	#plant_list {margin-left:20px; width:50%;}
	#plant {padding: 3px;}
	#plant:hover {background-color:#ffd;}
	#plant_info {height:50px;}
	#plant_details {position:absolute; background-color:#DACFB9; left:65%; width:250px; padding: 0px 5px 0px 5px;}
	#plant_buy {
		float:right;
		margin-top: 4px;
	}
	#plant_buy * { margin-top: 0; }
	#store_buttons {clear:both; padding-top:50px;}
	#plant_image {width:100px;float:left;}
	#garden_store {width:100%;}
	#plant_store_header {text-align:center;}
</style>

<div id="garden_store">

	<div class="halfWidth left">
		<div id="plant_store" class="contentBox">
			<div id="plant_store_header">
				<h1>Plant Mart</h1>
				<div id="availableNumPoints">Available: <%=@logged_in_user.avail_points%> points</div>
			</div>
			<ol>
				<% @plant_templates.each do |plant_template| %>
				<li>
				  <div id="plant" >
					<div id="plant_image"><%= image_tag("plants/#{plant_template.thumbnail}",:title => plant_template.name)%></div>
					<div id="plant_buy"><%= button_to plant_template.cost.to_s + " pts", :action=>:buy, :id=>plant_template.id %></div>
					<div id="plant_info"><%=h plant_template.name %></div>
					<div id="plant_description"><%=h plant_template.description %></div>
					<div class="clear"></div>
				  </div>
				  <div id="divider"></div>
				</li>
				<% end %>
			</ol>
		</div>
	</div>

	<div class="halfWidth right">
		<div id="gardenView" class="contentBox">

			<div id="gardenViewHeading">
				<h1>Garden Preview</h1>
				Click to plant your fireweed
			</div>

			<%@plantId = params[:pl]%>

			<div id="garden-viewport">
				<div class="garden">
					<%@garden.size_y.times do |y|%>
						<%@garden.size_x.times do |x|%>
							<div class="ground 
							<%if (y > 3) and @plantId and @garden.is_compatible(@plantId,x,y)%> highlighted" onclick="buy(<%=@plantId%>,<%=x%>,<%=y%>)<%end%>
							">
								<%ground = @garden.grounds.find_by_x_and_y(x,y)%>
								<%if ground != nil%>
									<%ground.plants.each do |plant|%>
										<%if plant.plant_template.image_path != nil%>
											<%img_url = "plants/#{plant.plant_template.image_path}"%>
											<%if @garden.size_y - y == 1%>
												<%img_url = img_url + "a.png"%>
											<%elsif @garden.size_y - y == 2%>
												<%img_url = img_url + "b.png"%>
											<%elsif @garden.size_y - y == 3%>
												<%img_url = img_url + "c.png"%>
											<%end%>
											<div class="plant_in_garden"><%=image_tag(img_url,:title => plant.name)%><br></div>
										<%end%>
									<%end%>
								<%end%>
							</div>
						<%end%>
						<div class="clear"></div>
					<%end%>
				</div>
			</div>
			<%= button_to "View your full garden", :controller=>:garden, :action=>:view %>
		</div>
	</div>
	<div class="clear"></div>
</div> 

<script>
	//Try to buy this plant, for planting at position x,y in the garden
	function buy(plantId, x, y)
	{
		if(plantId > 0 && x > 0 && y > 3 && x < 9 && y < 7)
			window.location.replace('/store/buyAndSave/' + plantId + '?x=' + x + '&y=' + y);
		else
			alert("We have a suspicion you're not green enough. Sorry, no plants for you.");	//TODO: agrandhi
	}
</script>
